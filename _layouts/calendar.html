---
layout: default
---

{% include base_path %}

<div id="main" role="main">
  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <div class="page__inner-wrap">
      <header>
        <h1 class="page__title" itemprop="headline">{{ page.title }}</h1>
      </header>

      <section class="page__content" itemprop="text">
        <div id="calendar-container"></div>

        <script>
          <!-- const eventsByDate = {
            {% for post in site.timetable %}
              "{{ post.date | date: '%Y-%m-%d' }}": (eventsByDate["{{ post.date | date: '%Y-%m-%d' }}"] || []).concat([
                {
                  title: "{{ post.title | escape }}",
                  url: "{{ post.url }}",
                  tags: [{% for tag in post.tags %}"{{ tag }}"{% unless forloop.last %}, {% endunless %}{% endfor %}]
                }
              ]),
            {% endfor %}
          }; -->

          const eventsByDate = {
            {% assign dates_seen = "" %}
            {% for post in site.timetable %}
              {% assign post_date = post.date | date: "%Y-%m-%d" %}
              {% unless dates_seen contains post_date %}
                "{{ post_date }}": [
                  {% for p in site.timetable %}
                    {% assign d = p.date | date: "%Y-%m-%d" %}
                    {% if d == post_date %}
                      {
                        title: "{{ p.title | escape }}",
                        url: "{{ p.url }}",
                        tags: [{% for tag in p.tags %}"{{ tag }}"{% unless forloop.last %}, {% endunless %}{% endfor %}]
                      }{% unless forloop.last %},{% endunless %}
                    {% endif %}
                  {% endfor %}
                ],
                {% assign dates_seen = dates_seen | append: post_date | append: "," %}
              {% endunless %}
            {% endfor %}
          };
          

          function renderCalendar(year, month, events) {
            const container = document.getElementById('calendar-container');
            container.innerHTML = '';

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            const header = document.createElement('div');
            header.className = 'calendar-header';
            ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(d => {
              const el = document.createElement('div');
              el.textContent = d;
              header.appendChild(el);
            });
            container.appendChild(header);

            const grid = document.createElement('div');
            grid.className = 'calendar-grid';

            for (let i = 0; i < firstDay; i++) {
              const empty = document.createElement('div');
              empty.className = 'calendar-cell empty';
              grid.appendChild(empty);
            }

            for (let d = 1; d <= daysInMonth; d++) {
              const cell = document.createElement('div');
              cell.className = 'calendar-cell';
              const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
              const dateNumber = document.createElement('div');
              dateNumber.className = 'date-number';
              dateNumber.textContent = d;
              cell.appendChild(dateNumber);

              if (events[dateStr]) {
                events[dateStr].forEach(e => {
                  const el = document.createElement('div');
                  el.className = 'calendar-event';
                  el.innerHTML = `<a href="${e.url}">${e.title}</a>`;
                  cell.appendChild(el);
                });
              }

              grid.appendChild(cell);
            }

            container.appendChild(grid);
          }

          const now = new Date();
          renderCalendar(now.getFullYear(), now.getMonth(), eventsByDate);
        </script>

        <style>
          #calendar-container {
            max-width: 960px;
            margin: 0 auto;
          }

          .calendar-header, .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            text-align: center;
          }

          .calendar-header div {
            font-weight: bold;
            padding: 0.5rem;
            background: #f2f2f2;
            border-bottom: 1px solid #ddd;
          }

          .calendar-cell {
            background: #fff;
            border: 1px solid #e0e0e0;
            min-height: 120px;
            position: relative;
            padding: 4px;
            text-align: left;
          }

          .calendar-cell.empty {
            background: #fafafa;
            border: none;
          }

          .date-number {
            position: absolute;
            top: 4px;
            right: 6px;
            font-size: 0.8rem;
            color: #888;
          }

          .calendar-event {
            font-size: 0.85rem;
            margin-top: 1.2rem;
            line-height: 1.3;
          }

          .calendar-event a {
            color: #007acc;
            text-decoration: none;
          }

          .calendar-event a:hover {
            text-decoration: underline;
          }
        </style>
      </section>
    </div>
  </article>
</div>